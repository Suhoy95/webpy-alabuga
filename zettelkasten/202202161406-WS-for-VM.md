# 202202161406 подготовка VM для тестирования WorldSkills

## Настройка сервера SSH

> Стоит тестировать SSH-подключение без отключения SSH-соединения.
> Так как при ошибки конфигурации вы можете потерять доступ по SSH.

0. Конфигурационный файл: `/etc/ssh/sshd_config`
1. Только не забываем скопировать и проверить ssh-ключи (`ssh-copy-id`)
![](2022-02-16-16-22-03.png)
2.![](2022-02-16-16-34-37.png)
3. `systemctl reload sshd`
4. После того, как перепроверим, что всё работает сменим TCP-порт
![](2022-02-16-16-39-22.png)

### Настройка сообщения входа

1. ` /etc/motd`
![](2022-02-16-16-54-48.png)
2. Установка `fortune`
3. ` apt install fortune-mod fortunes-ru fortunes`
4. `echo "/usr/games/fortune" >> /etc/bash.bashrc`
5. ![](2022-02-16-17-00-47.png)

## Генерация списка студентов и паролей

```bash
for i in `seq 1 24`; do
    echo "std${i}";
    (tr -dc A-Za-z0-9 </dev/urandom | head -c 13 ; echo '') > "std${i}_password".txt
done > students.txt
head students.txt
std1
std2
std3
std4
std5
std6
std7
std8
std9
std10
```

## Создание Пользователей для Участников WS

```bash
for i in `seq 1 24`; do
/usr/sbin/useradd -m "std${i}"
cat "std${i}_password".txt "std${i}_password".txt | passwd "std${i}"
done
```

## Установка и настройка nginx

```bash
apt-get install nginx
systemctl status nginx
```

![](2022-02-16-14-46-12.png)

### TODO: Настройка nginx для Module1 (Django/Python)

### Настройка nginx для Module2 (HTML/JS)

```bash
echo "" > /etc/nginx/sites-enabled/jan.ws.conf
for i in `seq 1 24`; do
cat >> /etc/nginx/sites-enabled/jan.ws.conf <<HERE
server {
       listen 80;
       listen [::]:80;
       server_name std${i}.gramend.ru;

       root /home/std${i}/jan/module1;
       index index.html;

       location / {
               try_files \$uri \$uri/ =404;
       }
}
HERE
done
```