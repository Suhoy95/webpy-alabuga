<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title>WEB/Python</title>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet"/>
<style>
        /* Заглушка,, чтобы больше скриншоты не вылезали за границы контейнера */
        img {
            display: block;
            max-width: 100%;
            margin: 10px auto 10px;
            border: green solid 3px;
            border-radius: 5px;
        }
        body {
            font-size: 18px;
        }
    </style>
</head>
<body>
<header></header>
<main class="container">
<h1>202202161616 Развертывание (deploy) статических файлов (HTML/CSS/JS) по <strong>SSH</strong></h1>
<h2>Описание / Цель</h2>
<p>Любой КОД (задание для ДЭ) для WorldSkills подразумевает полный цикл, то есть
сделанный проект должен быть не просто сделан, а также выложен и доступен по
какому-то адресу.</p>
<p>Любое развертывание проекта начинается с
1) Подключения к серверу
2) Копировании файлов на сервер
3) Настройки WEB сервера и WEB-приложения (если требуется)</p>
<p>В нашем случае, WEB-сервер пока <a href="202202161406-WS-for-VM.html">настроен заранее</a>,
и сейчас мы на примере <a href="202202150946-WS-module-2.html">Модуля 2</a> рассмотрим
как выложить наши статические файлы.</p>
<h2>Что потребуется</h2>
<ol>
<li><a href="https://gitforwindows.org/" rel="noopener noreferrer nofollow" target="_blank">GitBash for Windows</a> - имеет в коробке клиент ssh и сопутствующие утилиты.</li>
<li>Данные для входа:<ul>
<li><code>Hostname: std0.gramend.ru</code></li>
<li><code>Port SSH: 27452</code> (Сменен со стандартного <code>22</code>, чтобы избежать лишних случайных сканирований bot-программами)</li>
<li><code>Username: std0</code></li>
<li><code>Password: ***********</code></li>
<li>Папка куда нужно скопировать файлы: <code>/home/std0/jan/module2/</code></li>
</ul>
</li>
</ol>
<h2>Шаги</h2>
<h3>Подключение к серверу</h3>
<p><img alt="" src="2022-02-18-13-01-08.png"/></p>
<ol>
<li>Используем команду <code>ssh</code>, чтобы подключится:<ul>
<li><code>-p</code> - указываем TCP-порт на котором работает SSH сервер</li>
<li>до <code>@</code> указывается имя пользователя</li>
<li>после <code>@</code> указывает имя сервера</li>
<li>Для деталей лучше выучить <a href="https://ru.wikipedia.org/wiki/URL" rel="noopener noreferrer nofollow" target="_blank">полную схему URL</a></li>
</ul>
</li>
<li>Сверяем отпечаток ключа сервера, так мы проверяем что подключаемся туда куда нужно:
<code>ED25519 key fingerprint is SHA256:0wxSlgfhoASh/WioGHAOMBUYx2+1xR9LeSelhxUvW8k</code></li>
<li>Если все верно, пишем <code>yes</code></li>
<li>И попадаем в терминал</li>
<li>Выйти можно по сочетанию клавиш <code>^D/ctrl+D</code></li>
</ol>
<h3>Подключение к серверу без пароля</h3>
<p>Чтобы подключаться по SSH без ввода пароля, можно скопировать свой публичный ключ
<code>.ssh/id_rsa.pub</code> в <code>.ssh/authorized_keys</code> на сервер. Также для этого можно
воспользоваться утилитой <code>ssh-copy-id</code>:</p>
<p><img alt="" src="2022-02-18-13-12-21.png"/></p>
<h3>[Дополнительно] Настройка терминала сервера</h3>
<p>Полезно настраивать переменные окружения Shell, среды. Одна из таких - <code>PS1</code>,
которая отвечает за строку-приглашение. Как минимум,
полезно делать имя пользователя/компьютера разными цветами, чтобы случайно
не перепутать сервера, с которыми ты работаешь.</p>
<p>Делается это, с помощью файла .bashrc, который выполняется при входе:</p>
<p><img alt="" src="2022-02-18-13-23-18.png"/></p>
<p><img alt="" src="2022-02-18-13-23-48.png"/></p>
<h3>Копирование статических файлов</h3>
<ol>
<li>Проверяем что папка существует (если нет, придется её создать <code>mkdir -p</code>):</li>
</ol>
<p><img alt="" src="2022-02-18-13-29-09.png"/></p>
<ol>
<li>Пользуемся <code>scp</code>, чтобы скопировать файлы:</li>
</ol>
<p><img alt="" src="2022-02-18-13-33-06.png"/></p>
<h3>Проверка</h3>
<p>Заходим на <code>std0.gramend.ru</code>, вводим те же имя пользователя и пароль (HTTP базовая авторизация)
и убеждаемся, что все работает:</p>
<p><img alt="" src="2022-02-18-13-36-11.png"/></p>
<h2>Заметки</h2>
<ol>
<li>Стоит сделать какой-то скрипт для автоматической загрузки страницы на HTTP-сервер,
чтобы быстро исправлять ошибки и перезагружать новую версию на сервер.</li>
<li>Можно даже сделать это при коммите, например (Совет для WorldSkill!, в реальной жизни авто-деплой стоит реализовывать сложнее)</li>
</ol>
</main>
<footer></footer>
<script crossorigin="anonymous" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
