<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title>WEB/Python</title>
<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet"/>
<style>
        /* Заглушка,, чтобы больше скриншоты не вылезали за границы контейнера */
        img {
            display: block;
            max-width: 100%;
            margin: 10px auto 10px;
            border: green solid 3px;
            border-radius: 5px;
        }
        body {
            font-size: 18px;
        }
    </style>
</head>
<body>
<header></header>
<main class="container">
<h1>202202151200 fetch maps.json</h1>
<p>Что-бы выполнить HTTP-запрос, наша HTML-страница должна быть на каком-нибудь простом
WEB/HTTP-сервере, иначе могут возникнуть ограничения браузера при попытке отправить запрос.</p>
<h2>Проверка доступности файла <code>maps.json</code> по HTTP</h2>
<p>К счастью Live-Server - это и есть просто HTTP-сервер. И карта maps.json будет
доступна по HTTP точно также как и <code>index.html</code>:</p>
<p><img alt="" src="2022-02-15-12-03-57.png"/></p>
<p>Поэтому мы будем делать относительный запрос (относительно <code>index.html</code>) к
<code>./maps.json</code> (или просто <code>maps.json</code>):</p>
<p><img alt="" src="2022-02-15-12-05-55.png"/></p>
<p>Теперь, мы можем убедится в разделе отладки что HTTP-запрос выполнился:</p>
<p><img alt="" src="2022-02-15-12-06-52.png"/></p>
<h2>Отправка HTTP-запроса методом <code>fetch()</code></h2>
<p>Метод fetch не выполняет HTTP-запрос сразу, а говорит браузеру его сделать и
возвращает в JS объект <code>Promise</code>, то есть обещание, которое когда-нибудь будет
выполнено. Чтобы обработать результат <code>Promise-а</code> нам нужно зарегистрировать
колбэк (Функцию обратного вызова), который выполнится, когда браузер
совершит HTTP-запрос.</p>
<p>Делается это с помощью метода <code>.then(callback)</code>:</p>
<p><img alt="" src="2022-02-15-12-10-44.png"/></p>
<p>Обновляем страницу, смотрим результат в консоли:</p>
<p><img alt="" src="2022-02-15-12-11-26.png"/></p>
<h2>Получение JSON-данных в виде JavaScript-объекта (Парсинг JSON)</h2>
<p>Чтобы из HTTP-ответа данные распарсились как JSON-объект есть метод <code>.json()</code>,
которые это сделает. Но он также возвращает <code>Promise</code>, поэтому код будет выглядеть так:</p>
<p><img alt="" src="2022-02-15-12-13-54.png"/></p>
<p>И проверка в консоли:</p>
<p><img alt="" src="2022-02-15-12-14-21.png"/></p>
<h2>Следующие шаги</h2>
<ol>
<li>Ура мы получили массив из JSON-файла запросом, теперь можем перейти к
<a href="202202151256-fill-choose-map-list.html">отображению карт на <code>Экране Выбора Карт</code></a>.</li>
<li>В данном примере мы сделали работу на <code>Promise</code> в учебных целях, стоит
прочитать про них подробнее и перейти на <code>async/await</code>. См <a href="202202151313-js-marathon-8.html">JS-Марафон. 8 день</a></li>
</ol>
</main>
<footer></footer>
<script crossorigin="anonymous" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
